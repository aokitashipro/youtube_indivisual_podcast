# Git初期設定コマンド

## 🎯 このコマンドの目的
プロジェクトのGit管理を開始し、GitHubリポジトリと連携する

## 📋 前提条件
- [ ] GitHubアカウントを持っている
- [ ] GitHubに新しいリポジトリを作成済み（または作成する）
- [ ] プロジェクトディレクトリにいる

## 🚀 実行手順

### ステップ1: Gitリポジトリの初期化

```bash
# 現在のディレクトリを確認
pwd
# 出力: /Users/a-aoki/indivisual/youtube-ai

# Gitリポジトリを初期化
git init
```

**期待される出力:**
```
Initialized empty Git repository in /Users/a-aoki/indivisual/youtube-ai/.git/
```

---

### ステップ2: .gitignoreの確認

```bash
# .gitignoreが存在することを確認
cat .gitignore

# 重要なファイルが除外されているか確認:
# - .env (環境変数)
# - assets/credentials/ (認証情報)
# - temp/ (一時ファイル)
# - *.mp3, *.mp4 (生成ファイル)
# - logs/ (ログファイル)
```

**問題がある場合:**
`.gitignore` が不完全な場合は、必要な項目を追加してください。

---

### ステップ3: 初回コミット

```bash
# 現在のステータスを確認
git status

# すべてのファイルをステージング
git add .

# 初回コミット
git commit -m "Initial commit: プロジェクト構造とドキュメント作成

- main.py: ステップ1-3実装済み
- modules/: 各モジュールの基本実装
- utils/: ロガー、エラーハンドラー、タイマー
- config/: 設定ファイルとプロンプト
- docs/: 詳細ドキュメント
- .cursor/rules/: AIアシスタント用ルール
- tests/: テストファイル
- assets/: 静的ファイル用ディレクトリ"
```

**期待される出力:**
```
[main (root-commit) abc1234] Initial commit: プロジェクト構造とドキュメント作成
 XX files changed, XXX insertions(+)
 create mode 100644 main.py
 ...
```

---

### ステップ4: GitHubリポジトリの作成（まだの場合）

**ブラウザで操作:**
1. https://github.com/new にアクセス
2. リポジトリ名: `youtube-ai-podcast`
3. 説明: `AIを使用したYouTubeポッドキャスト自動生成システム`
4. Private または Public を選択
5. **「Initialize this repository with」のチェックは全て外す**
6. 「Create repository」をクリック

---

### ステップ5: GitHubリポジトリと連携

```bash
# リモートリポジトリを追加
# ⚠️ your-username を実際のGitHubユーザー名に置き換えてください
git remote add origin https://github.com/your-username/youtube-ai-podcast.git

# リモートリポジトリを確認
git remote -v
```

**期待される出力:**
```
origin  https://github.com/your-username/youtube-ai-podcast.git (fetch)
origin  https://github.com/your-username/youtube-ai-podcast.git (push)
```

---

### ステップ6: メインブランチの設定とプッシュ

```bash
# ブランチ名をmainに変更（古いGitの場合masterになっている可能性あり）
git branch -M main

# GitHubにプッシュ
git push -u origin main
```

**初回プッシュ時に認証を求められた場合:**
- Username: GitHubのユーザー名
- Password: Personal Access Token（パスワードではない）

**Personal Access Tokenの作成方法:**
1. GitHub → Settings → Developer settings → Personal access tokens → Tokens (classic)
2. Generate new token (classic)
3. repo 権限にチェック
4. Generate token
5. 表示されたトークンをコピー（一度しか表示されない）

---

### ステップ7: 開発用ブランチの作成

```bash
# developブランチを作成して切り替え
git checkout -b develop

# developブランチをGitHubにプッシュ
git push -u origin develop

# ブランチ一覧を確認
git branch -a
```

**期待される出力:**
```
* develop
  main
  remotes/origin/main
  remotes/origin/develop
```

---

### ステップ8: ブランチ保護設定（推奨）

**GitHubのWebインターフェースで:**
1. リポジトリページ → Settings → Branches
2. Branch protection rules → Add rule
3. Branch name pattern: `main`
4. 以下をチェック:
   - ☑ Require a pull request before merging
   - ☑ Require approvals (1)
5. Save changes

**これにより:**
- mainブランチへの直接プッシュを防止
- developからのPull Requestが必要
- コードレビューが可能

---

## ✅ 完了確認

以下のコマンドで状態を確認：

```bash
# ブランチ一覧
git branch -a

# リモートリポジトリ
git remote -v

# 現在のブランチ
git branch --show-current
```

**期待される状態:**
- ✅ main ブランチが存在
- ✅ develop ブランチが存在
- ✅ 現在 develop ブランチにいる
- ✅ origin リモートが設定済み
- ✅ GitHubに両方のブランチがプッシュ済み

---

## 🎯 次のステップ

初期設定が完了したら、次のコマンドに進んでください：
- `02-新しいステップの実装開始.md` - 新しいfeatureブランチを作成
- `ブランチ管理表.md` - 実装状況を確認

---

## 🆘 トラブルシューティング

### エラー: fatal: not a git repository
```bash
# Gitが初期化されていない
git init
```

### エラー: remote origin already exists
```bash
# 既存のリモートを削除して再追加
git remote remove origin
git remote add origin https://github.com/your-username/youtube-ai-podcast.git
```

### エラー: failed to push some refs
```bash
# リモートの変更を先に取得
git pull origin main --allow-unrelated-histories
git push -u origin main
```

### 認証エラー
```bash
# Personal Access Tokenを使用
# Username: GitHubユーザー名
# Password: Personal Access Token（パスワードではない）
```

---

## 📝 補足情報

### SSH接続を使用する場合（推奨）

```bash
# SSH鍵が設定済みの場合
git remote set-url origin git@github.com:your-username/youtube-ai-podcast.git

# SSH鍵の設定方法:
# 1. ssh-keygen -t ed25519 -C "your_email@example.com"
# 2. cat ~/.ssh/id_ed25519.pub をコピー
# 3. GitHub → Settings → SSH and GPG keys → New SSH key
```

### gitignoreに追加漏れがあった場合

```bash
# 既にコミット済みのファイルをtrackingから外す
git rm --cached -r assets/credentials/
git rm --cached .env

# .gitignoreを更新してコミット
git add .gitignore
git commit -m "fix: .gitignoreを更新"
```

